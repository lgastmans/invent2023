<?if (file_exists("include/db.inc.php"))	require_once("include/db.inc.php");else if (file_exists("../include/db.inc.php"))	require_once("../include/db.inc.php");else if (file_exists("../../include/db.inc.php"))	require_once("../../include/db.inc.php");function check_jpg($str_search) {	$int_val = 0;		$pos = strrpos(strtolower($str_search), ".");		if ($pos > 0) {		$str_type = strtoupper(substr($str_search, ($pos+1), strlen($str_search)));		if (($str_type === 'JPG') || ($str_type === 'JPEG'))		$int_val = 1;	}		return $int_val;}function resize($cur_file, $cur_file_type, $newwidth, $output_dir) {	if (!function_exists('imagecreatefromjpeg')){		return "Unable to convert image - GD Library Not Installed";	}	$filename = $cur_file;	$format=''; 	if (!empty($cur_file_type)) {		if ($cur_file_type=='image/pjpeg')			$cur_file_type='image/jpeg';		if (($cur_file_type=='image/jpeg') || ($cur_file_type=='image/png') ||($cur_file_type=='image/gif'))			$format = $cur_file_type;			}	else {		$format='';		if(preg_match("/.jpg/i", "$filename")) {			$format = 'image/jpeg';		}		if(preg_match("/.gif/i", "$filename")) {			$format = 'image/gif';		}		if(preg_match("/.png/i", "$filename")) {		$format = 'image/png';		}	}	if($format!='') {		list($width, $height) = getimagesize($filename);			if ($width>$height) {			$newheight=$height*$newwidth/$width;			$newheight=intval($newheight);		}		else {			$newheight=$newwidth;			$newwidth=$width*$newheight/$height;			$newwidth=intval($newwidth);		}				$thumb = imagecreatetruecolor($newwidth,$newheight);		imagealphablending($thumb, false);				switch($format){			case 'image/jpeg':				$source = imagecreatefromjpeg($filename);				break;			case 'image/gif';				$source = imagecreatefromgif($filename);				break;			case 'image/png':				$source = imagecreatefrompng($filename);				break;		}				imagecopyresampled($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);				switch($format) {			case 'image/jpeg':				imagejpeg($thumb, $output_dir);				break;			case 'image/gif';				imagegif($thumb, $output_dir);				break;			case 'image/png':				imagepng($thumb, $output_dir);				break;		}				return "*";	}	else {		return "No image type...";    }}function getAllSuppliers() {	$qry = new Query("SELECT supplier_id, supplier_name FROM stock_supplier ORDER BY supplier_name");	$retval = array();	for ($i=0;$i<$qry->RowCount();$i++) {		$retval[$qry->FieldByName('supplier_id')] = $qry->FieldByName('supplier_name');		$qry->Next();	}	return $retval;}    function buildTaxList() {    $category_query = new Query("select * from ".Monthalize('stock_tax')." order by tax_description");    for ($i=0;$i<$category_query->RowCount();$i++) {    	$res[$i]["tax_id"] = $category_query->FieldByName("tax_id");	$res[$i]["tax_description"] = $category_query->FieldByName("tax_description");;	$category_query->Next();    }    return $res;  }  function buildTaxDefinitionList() {    $category_query = new Query("select * from ".Monthalize('stock_tax_definition')." order by definition_description");    for ($i=0;$i<$category_query->RowCount();$i++) {    	$res[$i]["definition_id"] = $category_query->FieldByName("definition_id");	$res[$i]["definition_description"] = $category_query->FieldByName("definition_description");;	$category_query->Next();    }    return $res;  }      function buildCompleteCategoryPath($aFolder) {  	$sql = new Query("select category_id,parent_category_id,category_description from stock_category where category_id=$aFolder");	$curFolder=$aFolder;		$res=$sql->FieldByName("category_description");	while (($curFolder>0)) {		   $sql = new Query("select category_id,parent_category_id,category_description from stock_category where category_id=".$sql->FieldByName("parent_category_id"));	   $curFolder=$sql->FieldByName("category_id");       $res=$sql->FieldByName("category_description")." ".$res;       	}		return $res;  }      function buildCategoryList() {    $category_query = new Query("select * from stock_category order by parent_category_id, category_description");    for ($i=0;$i<$category_query->RowCount();$i++) {    	$res[$i]["category_id"] = $category_query->FieldByName("category_id");		$res[$i]["category_description"] = buildCompleteCategoryPath($res[$i]["category_id"]);		$category_query->Next();    }    return $res;  } ?>